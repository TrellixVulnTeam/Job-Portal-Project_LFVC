{% extends 'jportal/base.html' %}
{% load staticfiles %}
{% load app_tags %}

{% block title_block %}
  Job Details
{% endblock %}

{% block scripts_here %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src = "{% static "scripts/one.js" %}"></script>
{% endblock %}

{% block body_block %}
  {% include "jportal/sidebar_emp.html" %}
<div class="container" style="width:70%;">
  {% if jobs %}
    <h2 style="padding: 5px; background-color:grey; color:ghostwhite; border-radius: 2px;">
      Applications for your posted jobs
    </h2>
    <div class="jumbotron"> 
      <ul>
        {% for job in jobs %}
          <div class="panel-group" style="width:50%">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h4 class="panel-title">
                  <a data-toggle="collapse" href="#{{ job.id }}">
                    {{ job.title }}
                  </a>
                </h4>
              </div>
              <div id="{{ job.id }}" class="panel-collapse collapse">
                <div class="panel-footer">
                    Number of applicatants: {% get_app_count job.id %}
                </div>
                <div class="panel-body">
                  {% has_app job as application %}
                  {% if application %}
                    Appliers are
                    <ul>
                      {% for apps in application %}
                      {% get_appliers apps as ap_name %}
                      <li>
                        <div>
                          <a href="{% url 'jobseeker_profile' ap_name %}">{{ap_name}}</a>
                          <button id="{{ apps.jobseeker_id }}" data-toggle="modal"
                            data-target="#appAction" class="action btn-info" value="{{ job.id }}"
                            style="margin: 5px;">
                            Action
                          </button>
                        </div>
                      </li>
                      {% endfor %}
                    </ul>
                  {% else %}
                    No appliers yet.
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </ul>
    </div>
  {% else %}
    <h3>You haven't posted any jobs yet.</h3>
  {% endif %}
</div>

<!-- Action Modal -->
<div class="modal fade" id="appAction" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">What do you want to do with this application?</h4>
      </div>
      <div class="modal-footer">
        <button value="approved" type="button" class="approve btn btn-primary">Approve</button>
        <button value="rejected" type="button" class="reject btn btn-primary">Reject</button>
      </div>
    </div>    
  </div>
</div>
{% endblock %}